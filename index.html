<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Compacto</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
  margin:0;
  padding:20px;
  background:#f3f4f6;
  font-family:'Inter', sans-serif;
  color:#0f172a;
  display:flex;
  justify-content:center;
  align-items:flex-start;
}

.card{
    border-radius:10px;
    background:#fff;
    box-shadow:0 6px 20px rgba(15,23,42,0.1);
    padding:16px;
    width:100%;
    max-width:380px;
    display:flex;
    flex-direction:column;
    gap:8px;
}

/* Título do dashboard */
.titulo-dashboard{
    font-weight:700;
    font-size:18px;
    margin-bottom:8px;
    text-align:center;
}

/* Dropdown período */
#btnPeriodo{
    border:1px solid #ccc;
    background:#f9f9f9;
    padding:6px 10px;
    border-radius:6px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    cursor:pointer;
    font-size:14px;
}
#periodoDrop{
    display:none;
    flex-direction:column;
    border:1px solid #ccc;
    border-radius:6px;
    margin-top:4px;
}
.option{
    padding:6px 10px;
    cursor:pointer;
    font-size:14px;
}
.option.selected{ background:#e2e8f0; }
#btnCalendario{ padding:6px 10px; cursor:pointer; color:#007bff; font-size:14px; }
#calendarInput { position: absolute; left: -9999px; }

/* Seções métricas */
.secao {
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:2px;
}
.secao-icon{ font-size:22px; }
.titulo{ font-weight:bold; font-size:13px; }
.valor{ font-size:15px; }

/* Cores por seção */
.faturamento{ color:#228B22; }
.vendas{ color:#007bff; }
.conversao{ color:#FFA500; }
.ticket{ color:#8A2BE2; }

/* Linha de separação */
.hr-separator{
    border:none;
    border-top:1px solid #e2e8f0;
    margin:8px 0;
}

/* Gráfico */
.chart-wrap{
    width:100%;
    height:150px; /* menor altura para caber na tela */
    position:relative;
}
.center-total{
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    text-align:center;
    pointer-events:none;
}
.center-total .label{ color:#6b7280; font-size:11px; }
.center-total .num{ font-weight:700; font-size:14px; margin-top:2px; }

.legend-row{
    display:flex;
    gap:12px;
    justify-content:center;
    margin-top:6px;
}
.legend-item{
    display:flex;
    gap:6px;
    align-items:center;
    font-size:12px;
    color:#6b7280;
    cursor:pointer;
}
.legend-swatch{
    width:10px;
    height:10px;
    border-radius:2px;
}
</style>
</head>
<body>

<div class="card">
    <div class="titulo-dashboard">Dashboard</div>

    <!-- Botão período -->
    <div id="btnPeriodo">
        <span id="periodoSelected">Hoje</span>
        <i class="bi bi-chevron-down arrow"></i>
    </div>

    <!-- Dropdown -->
    <div id="periodoDrop">
        <div class="option selected" data-value="Hoje">Hoje</div>
        <div class="option" data-value="Ontem">Ontem</div>
        <div class="option" data-value="Últimos 7 dias">Últimos 7 dias</div>
        <div class="option" data-value="Últimos 30 dias">Últimos 30 dias</div>
        <div id="btnCalendario">Calendário</div>
        <input type="date" id="calendarInput">
    </div>

    <!-- Seções métricas -->
    <div class="secao">
        <i class="bi bi-cash-coin secao-icon"></i>
        <div class="titulo">Faturamento</div>
        <div class="valor faturamento">100 MZN</div>
    </div>
    <div class="secao">
        <i class="bi bi-cart-check-fill secao-icon"></i>
        <div class="titulo">Vendas Realizadas</div>
        <div class="valor vendas">50</div>
    </div>
    <div class="secao">
        <i class="bi bi-graph-up secao-icon"></i>
        <div class="titulo">Taxa de Conversão</div>
        <div class="valor conversao">6%</div>
    </div>
    <div class="secao">
        <i class="bi bi-receipt secao-icon"></i>
        <div class="titulo">Ticket Médio</div>
        <div class="valor ticket">2 MZN</div>
    </div>

    <!-- Linha de separação -->
    <hr class="hr-separator">

    <!-- Gráfico de vendas -->
    <div class="chart-wrap">
        <canvas id="doughnutChart"></canvas>
        <div class="center-total">
            <div class="label">TOTAL</div>
            <div class="num" id="centerValue">0 MT</div>
            <div style="font-size:11px;color:#6b7280;margin-top:2px;">M-Pesa + E-Mola</div>
        </div>
    </div>

    <div class="legend-row">
        <div class="legend-item" data-index="0"><div class="legend-swatch" style="background:#FF4136"></div>M-Pesa</div>
        <div class="legend-item" data-index="1"><div class="legend-swatch" style="background:#FFA500"></div>E-Mola</div>
    </div>
</div>

<script>
// Dropdown período
const btnPeriodo = document.getElementById("btnPeriodo");
const periodoDrop = document.getElementById("periodoDrop");
const options = document.querySelectorAll(".option");
const periodoSelected = document.getElementById("periodoSelected");
const btnCalendario = document.getElementById("btnCalendario");
const calendarInput = document.getElementById("calendarInput");

btnPeriodo.addEventListener("click", () => {
    periodoDrop.style.display = periodoDrop.style.display === "flex" ? "none" : "flex";
});

options.forEach(opt => {
    opt.addEventListener("click", () => {
        options.forEach(o => o.classList.remove("selected"));
        opt.classList.add("selected");
        periodoSelected.textContent = opt.dataset.value;
        periodoDrop.style.display = "none";
    });
});

btnCalendario.addEventListener("click", () => {
    calendarInput.focus();
    calendarInput.click();
});

calendarInput.addEventListener("change", () => {
    const date = new Date(calendarInput.value);
    if(date.toString() !== "Invalid Date"){
        const day = String(date.getDate()).padStart(2,'0');
        const month = String(date.getMonth()+1).padStart(2,'0');
        const year = date.getFullYear();
        periodoSelected.textContent = `${day}/${month}/${year}`;
        options.forEach(o => o.classList.remove("selected"));
        periodoDrop.style.display = "none";
    }
});

// Gráfico
const dataValues = [4000, 2400];
const dataLabels = ['M-Pesa','E-Mola'];
const total = dataValues.reduce((a,b)=>a+b,0);
document.getElementById('centerValue').textContent = total+' MT';

const ctx = document.getElementById('doughnutChart').getContext('2d');
const doughnutChart = new Chart(ctx, {
    type:'doughnut',
    data:{
        labels:dataLabels,
        datasets:[{
            data:dataValues,
            backgroundColor:['#FF4136','#FFA500']
        }]
    },
    options:{
        cutout:'62%',
        plugins:{
            legend:{ display:false },
            tooltip:{
                callbacks:{
                    label: function(context){
                        const val = context.raw;
                        const pct = ((val/total)*100).toFixed(1);
                        return `${context.label}: ${val} MT (${pct}%)`;
                    }
                }
            }
        },
        maintainAspectRatio:false
    }
});

// Legendinhas clicáveis
document.querySelectorAll('.legend-item').forEach(item=>{
  item.addEventListener('click',()=>{
    const index = item.dataset.index;
    const meta = doughnutChart.getDatasetMeta(0).data[index];
    meta.hidden = !meta.hidden;
    doughnutChart.update();
  });
});
</script>

</body>
</html>
